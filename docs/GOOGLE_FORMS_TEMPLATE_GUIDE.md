# Googleフォームテンプレート機能ガイド

## 概要
このアプリケーションでは、Googleフォームのアンケート作成を効率化するため、3つの方法を提供しています。

## 機能一覧

### 1. テンプレートからの手動作成（即座に利用可能）
最もシンプルな方法です。テンプレートの内容をクリップボードにコピーし、手動でGoogleフォームに貼り付けます。

**使い方:**
1. アンケートテンプレートを選択
2. 「手動で作成」をクリック
3. テンプレート内容が自動的にクリップボードにコピーされます
4. Googleフォームが開くので、貼り付けて質問を作成

**利点:**
- 設定不要ですぐに使える
- テンプレートの内容を確認しながら編集可能
- カスタマイズが簡単

### 2. エクスポート機能（3つの形式）
テンプレートを様々な形式でエクスポートできます。

**対応形式:**
- **テキスト形式**: 単純なテキストでの出力
- **JSON形式**: Google Forms API互換のJSON形式
- **Markdown形式**: ドキュメント化に便利な構造化された形式

**使い方:**
1. テンプレートのプレビュー画面でエクスポートボタン（↓）をクリック
2. 希望の形式を選択
3. クリップボードにコピーされます

### 3. 自動作成機能（Google Apps Script経由）
最も効率的な方法です。ボタンをクリックするだけで、自動的にGoogleフォームが作成されます。

**セットアップ手順:**

#### ステップ1: Google Apps Scriptプロジェクトの作成
1. [Google Apps Script](https://script.google.com/)にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を設定（例：Form Template Manager）

#### ステップ2: スクリプトの設置
1. `google_apps_script/google_forms_templates.gs`の内容をコピー
2. Google Apps Scriptエディタに貼り付け
3. 保存（Ctrl+S / Cmd+S）

#### ステップ3: テンプレートフォームの準備（オプション）
テンプレートクローン機能を使用する場合:
1. 各テンプレート用のマスターGoogleフォームを作成
2. フォームのURLからIDを取得
   - URL例: `https://docs.google.com/forms/d/1ABC123.../edit`
   - ID: `1ABC123...`
3. スクリプトの`TEMPLATE_FORMS`オブジェクトを更新

#### ステップ4: Web Appとしてデプロイ
1. 「デプロイ」→「新しいデプロイ」をクリック
2. 設定:
   - 種類: **ウェブアプリ**
   - 実行ユーザー: **自分**
   - アクセスできるユーザー: **全員**
3. 「デプロイ」をクリック
4. 表示されたWeb App URLをコピー

#### ステップ5: アプリケーションに設定
1. `lib/services/google_apps_script_service.dart`を開く
2. `_scriptUrl`を先ほどコピーしたURLに更新
3. アプリを再ビルド

## テンプレートの種類

### 事前アンケート用
- **基本情報アンケート**: 年齢、性別、学部などの基本属性
- **健康状態確認アンケート**: 実験参加に必要な健康状態の確認
- **実験参加同意書**: インフォームドコンセント

### 実験アンケート用
- **心理尺度評価アンケート**: 感情や気分の測定
- **認知課題評価アンケート**: 課題の難易度や主観的評価
- **ユーザビリティ評価アンケート**: システムやアプリのUX評価
- **行動観察記録アンケート**: 実験中の行動記録

### カスタムテンプレート
- 独自の質問項目を自由に作成可能

## トラブルシューティング

### Google Apps Scriptの権限エラー
初回実行時に権限承認が必要です:
1. 「詳細」をクリック
2. 「安全でないページに移動」を選択
3. 必要な権限を「許可」

### フォームが作成されない
- Google Apps ScriptのURLが正しく設定されているか確認
- ネットワーク接続を確認
- Google Apps Scriptのログを確認（表示→ログ）

### テンプレートが表示されない
- アプリを再起動
- キャッシュをクリア

## ベストプラクティス

1. **テンプレートの選択**
   - 実験の目的に最も適したテンプレートを選択
   - 必要に応じて複数のテンプレートを組み合わせる

2. **カスタマイズ**
   - テンプレートは出発点として使用
   - 実験の要件に応じて質問を追加・修正

3. **バックアップ**
   - 重要なフォームは定期的にバックアップ
   - JSONエクスポートを活用してテンプレートを保存

## 更新履歴
- v1.0: 初版リリース
  - 手動作成機能
  - 3形式でのエクスポート機能
  - Google Apps Script連携による自動作成機能

## サポート
問題が発生した場合は、以下の情報と共に報告してください:
- 使用している機能
- エラーメッセージ
- 実行した手順